---

#
#
# REMINDERS:
#
# - This role needs root privileges but it is preferred to run it as a
#   regular user that can sudo.
#
#

#
# Tear up
#

- include: "tear-up.yml"
  tags:
    - "always"

#
# archivematica-storage-service
#

- include: "archivematica-storage-service.yml"
  tags:
   - "amsrc-am-ss"


#
# archivematica pipeline install
#    (dashboard, MCP server, client)
#
#   0- Clone source repo
#   1- OS dependencies (debian packages)
#   2- python dependencies (pip packages)
#   3- OS configuration (user/directory/file creation/permissions/ownership )
#   4- Code install
#   5- Database config
#   6- web server config

- include: "pipeline-clonecode.yml"
  tags:
    - "amsrc-pipeline"
    - "amsrc-pipeline-clonecode"

- include: "pipeline-deps.yml"
  tags:
    - "amsrc-pipeline"
    - "amsrc-pipeline-deps"

- include: "pipeline-osconf.yml"
  tags:
    - "amsrc-pipeline"
    - "amsrc-pipeline-osconf"

- include: "pipeline-instcode.yml"
  tags:
    - "amsrc-pipeline"
    - "amsrc-pipeline-instcode"

- include: "pipeline-dbconf.yml"
  tags:
    - "amsrc-pipeline"
    - "amsrc-pipeline-dbconf"

- include: "pipeline-websrv.yml"
  tags:
    - "amsrc-pipeline"
    - "amsrc-pipeline-websrv"

#
# archivematica-devtools
#

- include: "archivematica-devtools.yml"
  tags:
    - "amsrc-devtools"
